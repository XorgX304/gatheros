{"command_groups": {"06.Service Information": [{"command": "ps -aux | grep root", "description": "View services running as root"}, {"command": "ps -aux | awk '{print $11}'|xargs -r ls -la 2>/dev/null |awk '!x[$0]++'", "description": "Lookup process binary path and permissions"}, {"command": "cat /etc/inetd.conf", "description": "List services managed by inetd"}, {"command": "cat /etc/xinetd.conf", "description": "As above for xinetd"}, {"command": "cat /etc/xinetd.conf 2>/dev/null | awk '{print $7}' |xargs -r ls -la 2>/dev/null", "description": "A very 'rough' command to extract associated binaries from xinetd.conf and show permissions of each"}, {"command": "ls -la /etc/exports 2>/dev/null; cat /etc/exports 2>/dev/null", "description": "Permissions and contents of /etc/exports (NFS)"}], "04.Environmental Information": [{"command": "env | grep -v 'LS_COLORS'", "description": "Display environmental variables"}, {"command": "echo $PATH", "description": "Path information"}, {"command": "history", "description": "Displays command history of current user"}, {"command": "pwd", "description": "Print working directory, i.e. 'where am I'"}, {"command": "cat /etc/profile", "description": "Display default system variables"}, {"command": "cat /etc/shells", "description": "Display available shells"}], "07.Jobs/Tasks": [{"command": "crontab -l", "description": "Display scheduled jobs for the specified user - Privileged command"}, {"command": "ls -la /etc/cron*", "description": "Scheduled jobs overview (hourly, daily, monthly etc)"}, {"command": "ls -aRl /etc/cron* | awk '$1 ~ /w.$/' 2>/dev/null", "description": "What can 'others' write in /etc/cron* directories"}], "02.Users and Groups": [{"command": "cat /etc/passwd", "description": "List all users on the system"}, {"command": "cat /etc/group", "description": "List all groups on the system"}, {"command": "for i in $(cat /etc/passwd 2>/dev/null | cut -d: -f1 2>/dev/null);do id $i; done 2>/dev/null", "description": "List all uid's and respective group memberships"}, {"command": "cat /etc/shadow", "description": "Show user hashes - Privileged command"}, {"command": "grep -v -E '^#' /etc/passwd | awk -F: '$3 == 0 { print $1}'", "description": "List all super user accounts"}, {"command": "who -a", "description": "Users currently logged in"}, {"command": "w", "description": "Who is currently logged in and what they are doing"}, {"command": "lastlog", "description": "Information on when all users last logged in"}, {"command": "lastlog -u $(whoami)", "description": "Information on when the specified user last logged in"}, {"command": "lastlog | grep -v 'Never'", "description": "Entire list of previously logged on users"}], "10.Buffer Overflow": [{"command": "cat /proc/sys/kernel/randomize_va_space", "description": "ASLR (0/1/2)"}, {"command": "cat /proc/cpuinfo | grep nx", "description": "- FULL"}], "01.Kernel, Operating System and Device Information": [{"command": "uname -r", "description": "Kernel release"}, {"command": "uname -n", "description": "System hostname"}, {"command": "uname -m", "description": "Linux Kernel architecture (32 or 64 bit)"}, {"command": "cat /proc/version", "description": "Kernel Information"}, {"command": "cat /etc/*-release", "description": "Distribution Information"}, {"command": "cat /proc/info", "description": "CPU Information"}, {"command": "df -a", "description": "File system Information"}], "03.User and Privilege Information": [{"command": "id", "description": "Current user information"}, {"command": "cat /etc/sudoers", "description": "Who's allowed to do what as root - Privileged command"}], "05.Interesting Files": [{"command": "find / -perm -4000 -type f 2>/dev/null", "description": "Find SUID files"}, {"command": "find / -uid 0 -perm -4000 -type f 2>/dev/null", "description": "Find SUID files owned by root"}, {"command": "find / -perm -2000 -type f 2>/dev/null", "description": "Find GUID files"}, {"command": "find / ! -path \"*/proc/*\" -perm -2 -type f -print 2>/dev/null", "description": "Find world-writeable files excluding those in /proc"}, {"command": "find / -perm -2 -type d 2>/dev/null", "description": "Find word-writeable directories"}, {"command": "find /home -name *.rhosts -print 2>/dev/null", "description": "Find rhost config files"}, {"command": "find /home -iname *.plan -exec ls -la {} \\; -exec cat {} 2>/dev/null \\;", "description": "Find *.plan files, list permissions and cat the file contents"}, {"command": "find /etc -iname hosts.equiv -exec ls -la {} 2>/dev/null \\; -exec cat {} 2>/dev/null \\;", "description": "Find hosts.equiv, list permissions and cat the file contents"}, {"command": "ls -la ~/.*_history", "description": "Show the current users' various history files"}, {"command": "ls -la /root/.*_history", "description": "Can we read root's history files"}, {"command": "ls -la ~/.ssh/", "description": "Check for interesting ssh files in the current users\u2019 directory"}, {"command": "find / -name \"id_dsa*\" -o -name \"id_rsa*\" -o -name \"known_hosts\" -o -name \"authorized_hosts\" -o -name \"authorized_keys\" 2>/dev/null |xargs -r ls -la", "description": "Find SSH keys/host information"}, {"command": "ls -la /usr/sbin/in.*", "description": "Check Configuration of inetd services"}, {"command": "grep -l -i pass /var/log/*.log 2>/dev/null", "description": "Check log files for keywords ('pass' in this example) and show positive matches"}, {"command": "find /var/log -name *.log -type f -exec ls -la {} \\; 2>/dev/null", "description": "List .log files in specified directory (/var/log)"}, {"command": "find / -maxdepth 4 -name *.conf -type f -exec grep -Hn password {} \\; 2>/dev/null", "description": "Find .conf files (recursive 4 levels) and output line number where the word 'password' is located"}, {"command": "lsof -i -n", "description": "List open files (output will depend on account privileges)"}, {"command": "head /var/mail/root", "description": "Can we read roots mail"}], "08.Networking, Routing and Communications": [{"command": "/sbin/ifconfig -a", "description": "List all network interfaces"}, {"command": "cat /etc/network/interfaces", "description": "As above"}, {"command": "arp -a", "description": "Display ARP communications"}, {"command": "route", "description": "Display route information"}, {"command": "cat /etc/resolv.conf", "description": "Show configured DNS sever addresses"}, {"command": "netstat -antp", "description": "List all TCP sockets and related PIDs (-p Privileged command)"}, {"command": "netstat -anup", "description": "List all UDP sockets and related PIDs (-p Privileged command)"}, {"command": "iptables -L", "description": "List rules - Privileged command"}, {"command": "cat /etc/services", "description": "View port numbers/services mappings"}], "09.Programs Installed": [{"command": "sudo -V", "description": "Sudo version - does an exploit exist?"}, {"command": "httpd -v", "description": "Apache version"}, {"command": "apache2 -v", "description": "As above"}, {"command": "apache2ctl -M", "description": "List loaded Apache modules"}, {"command": "mysql --version", "description": "Installed MYSQL version details"}, {"command": "psql -V", "description": "Installed Postgres version details"}, {"command": "perl -v | head -2", "description": "Installed Perl version details"}, {"command": "java -version 2>&1", "description": "Installed Java version details"}, {"command": "python --version 2>&1", "description": "Installed Python version details"}, {"command": "ruby -v", "description": "Installed Ruby version details"}, {"command": "for pr in", "description": "Locate 'useful' programs (netcat, wget etc)"}, {"command": "o which $pr; done", "description": "List available compilers"}], "00.Basic Information": [{"tag": "username", "command": "whoami", "description": "Current username"}, {"tag": "uid", "command": "id -u", "description": "Current UID"}, {"tag": "gid", "command": "id -g", "description": "Current GID"}, {"tag": "date", "command": "date", "description": "Date of the remote host"}, {"tag": "kernel", "command": "uname -a", "description": "Kernel build"}]}, "os_type": "linux", "name": "Basic Linux Enumeration"}